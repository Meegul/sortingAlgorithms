#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <string.h>
#include "mergeSort.h"
/*
* Function that creates and returns a new randomized int array of the specified size
*/
int* newArray(size_t size) {
        int *array = (int *) malloc(size *sizeof(int));
        int on;
        srand((unsigned)time(NULL));
	for (on = 0; on < 1000; on++) {
                array[on] = rand() % (size*10); //generates a random number between 0-(size*10)
        }
        return array;
}

/*
* Prints out the values in an int array
*/
void printArray(int* array, size_t size) {
        int x;
        int numInRow = 0;
        printf("[");
	for (x = 0; x < size; x++) {
                //moves to next line if there are 5 values displayed
		if (numInRow == 5) {
                        printf("\n ");
                        numInRow = 0;
                }
                printf("%d ", array[x]);
                numInRow++;
        }
        printf("]\n");
}

/*
* The infamous bogosort
* Randomly sorts an array, and repeats if that didn't sort it
*/
int* bogoSort(int *array, size_t size) {
	int* trackers = malloc(2*sizeof(int));
	int done = size - 1; //used to keep loop going until it reaches 0
	int x;
	int random;
	int temp;
	srand((unsigned)time(NULL)); //sets random() to use the current time as a seed
	while (done) {
		done = size - 1; //resets the done counter
		//shuffles array
		for (x = 0; x < size; x++) {
			random = rand() % size;		
			temp = array[random];
			array[random] = array[x];
			array[x] = temp;
			trakcers[1] += 4;
		}
		//checks if array is in order
		for (x = 0; x < size - 1; x++) { 	
			if (array[x] < array[x+1])
				done--; //decrements done if a value is in order 
			trackers[1] += 2;
			trackers[0]++;
		}
	}
	return trackers;
}

/*
* Sorts an array using the bubble sort method
*/
int* bubbleSort(int *array, size_t size) {
	int* trackers = malloc(2*sizeof(int));
	int x;
	int temp;
	int swaps = 1;
	while (swaps != 0) {
		swaps = 0;
		for (x = 0; x < size - 1; x++) {
			if (array[x] > array[x+1]) {
				temp = array[x+1];
				array[x+1] = array[x];
				array[x] = temp;
				trackers[1] += 4;
				swaps++;	
			}
			trackers[0]++;
			trackers[1] += 2;
		}
	}
	return trackers;
}

/*
*
*/
int* mergeSort(int* array, size_t size) {
	int* trackers = malloc(2*sizeof(int)); //[0] holds comparisons, [1] holds array accesses
	split(array, size, trackers);	
	return trackers;
}

int main(int argc, char **argv) {
	size_t size;
	int* trackers;
	//ensures that there are 2 arguments
	if (argc != 3) {
	printf("Usage: sortit [size to sort] [algorithm(bogo or bubble)]\n");
	return 1;
	}
	size = atoi(argv[1]); //sets size to the second argument passed
	int *array = newArray(size);
	//prints the initial array
	printf("Initial array:\n");
	printArray(array, size);
	char *selection = argv[2];
	//runs the appropriate sort
	if (strcmp(selection, "bogo") == 0)
		trackers = array = bogoSort(array, size);
	else if (strcmp(selection, "bubble") == 0)
		trackers = array = bubbleSort(array, size);
	else if (strcmp(selection, "merge") == 0)
		trackers = mergeSort(array, size);
	else printf("Usage: sortit [size to sort] [algorithm(bogo or bubble)]\n");
	//prints off the sorted array
	printf("Sorted array:\n");
	printArray(array, size);
	printf("Comparisons: %d, Array Accesses: %d\n", trackers[0], trackers[1]);
	return 0;
}
